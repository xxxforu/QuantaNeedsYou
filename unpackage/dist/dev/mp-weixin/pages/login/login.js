"use strict";const e=require("../../common/vendor.js"),r=require("../../utils/request.js"),s={__name:"login",setup(u){var n=e.ref(!1),a="";const o=e.getCurrentInstance();if(!o)throw new Error("getCurrentInstance must be called within setup or lifecycle hook.");const i=o.appContext.config.globalProperties.$getStaticFilePath;e.onLoad(()=>{e.index.getUserProfile&&(n.value=!0),console.log(n.value)});function d(){r.request({url:"student/login?code="+a,method:"POST"}).then(t=>{t.code===200?(e.index.setStorage({data:t.data.token,key:"token"}),e.index.setStorage({data:t.data.name,key:"userName"}),e.index.setStorage({data:t.data.studentNum,key:"studentNum"}),e.index.setStorage({data:t.data.faculty,key:"faculty"}),e.index.setStorage({data:t.data.grade,key:"grade"}),e.index.getStorage({key:"haveEnterTajiuzhaoni",success(){console.log("getSuccess")},fail(){e.index.setStorage({data:!0,key:"haveEnterTajiuzhaoni"})}}),e.index.navigateTo({url:"/pages/index/index"})):t.code==405?(e.index.setStorage({data:t.data,key:"openId"}),e.index.navigateTo({url:"/pages/info/info"})):e.index.showToast({icon:"none",duration:3e3,title:`${t.msg}`})})}function c(){e.index.login({success:function(t){console.log(t.code),t.code&&(a=t.code,d())}})}return(t,g)=>({a:e.unref(i)("loginBackground.png"),b:e.unref(i)("weixinLogo.png"),c:e.o(c)})}};wx.createPage(s);
